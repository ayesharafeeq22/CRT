class Solution {
    public int largestRectangleArea(int[] l) {
        Stack<Integer> s = new Stack<>();
        int maxArea = 0;
        int n = l.length;

        for (int i = 0; i <= n; i++) {
            int h;
            if (i == n) {
                h = 0;
            } else {
                h = l[i];
            }

            while (!s.isEmpty() && l[s.peek()] > h) {
                int height = l[s.pop()];  // height of the popped bar
                int w;
                if (s.isEmpty()) {
                    w = i;
                } else {
                    w = i - s.peek() - 1;
                }
                maxArea = Math.max(maxArea, height * w);
            }

            s.push(i);
        }

        return maxArea;
    }
}